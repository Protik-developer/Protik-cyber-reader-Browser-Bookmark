javascript:(()=>{try{if(window.__PRA2_V2)return;window.__PRA2_V2=1;const q=speechSynthesis;let r=[],s=null,t=null,u=[],v=0,w="paragraph",x=!1;function y(a){function b(){r=q.getVoices();r.length?a&&a():setTimeout(b,200)}b();speechSynthesis.onvoiceschanged=b}const z=document.createElement("style");z.textContent="@keyframes a0{0%{box-shadow:0 0 6px #00ffd5}50%{box-shadow:0 0 18px #00ffd5}100%{box-shadow:0 0 6px #00ffd5}}.a1{background:#00ffd5;color:#000;border-radius:4px;padding:1px 3px;animation:a0 .6s infinite}.a2{position:fixed;top:90px;right:70px;width:360px;background:#050014;color:#eaffff;border-radius:20px;padding:14px;font-family:system-ui;z-index:2147483647;box-shadow:0 0 30px #00ffd5;cursor:grab;transition:opacity .3s}.a2 button{margin:2px;padding:4px 8px;border-radius:6px;border:none;background:#0b1024;color:#00ffd5;cursor:pointer}.a2 select,.a2 input[type=range]{margin:4px 0;border-radius:6px;border:none;background:#0b1024;color:#00ffd5}.a3{display:flex;flex-wrap:wrap;gap:4px;align-items:center}.a3 label{font-size:11px;opacity:.8}.a4{margin-left:4px}";document.head.appendChild(z);function A(){return String.fromCharCode(80,114,111,116,105,107)}function B(){return[String.fromCharCode(67,121,98,101,114),"Reader","v2"].join(" ")}const C=document.createElement("div");C.className="a2";C.innerHTML="<b>‚ö° "+A()+" "+B()+"</b><br><small>Made by "+A()+"</small><hr><div class='a3'><select id='a5' style='width:100%'></select></div><div class='a3'><label>Speed</label><input id='a6' type='range' min='0.6' max='2' step='0.1' value='1'><label>Vol</label><input id='a7' type='range' min='0' max='1' step='0.05' value='1'></div><div class='a3'><label>Mode:</label><select id='a8' class='a4'><option value='paragraph'>Paragraph</option><option value='sentence'>Sentence</option></select><button id='a9'>üîä Preview</button></div><div class='a3'><button id='aa'>‚ñ∂ Play</button><button id='ab'>‚è∏ Pause</button><button id='ac'>‚èπ Stop</button></div><div class='a3'><button id='ad'>‚èÆ Prev</button><button id='ae'>‚è≠ Next</button><button id='af'>üìÑ Read Page</button></div><div class='a3'><button id='ag'>üñå Theme</button><button id='ah'>üåÄ Compact</button><button id='ai' style='margin-left:auto'>‚úï</button></div>";document.body.appendChild(C);const D=C.querySelector("#a5"),E=C.querySelector("#a6"),F=C.querySelector("#a7"),G=C.querySelector("#a8"),H=C.querySelector("#aa"),I=C.querySelector("#ab"),J=C.querySelector("#ac"),K=C.querySelector("#ad"),L=C.querySelector("#ae"),M=C.querySelector("#af"),N=C.querySelector("#ag"),O=C.querySelector("#ah"),P=C.querySelector("#ai"),Q=C.querySelector("#a9"),R=["#050014","#001100","#140005","#0a0014"];let S=0,T=!1;function U(){try{const a=JSON.parse(localStorage.getItem("praSettingsV2")||"{}");null!=a.themeIndex&&(S=a.themeIndex);null!=a.compact&&(T=a.compact);null!=a.rate&&(E.value=a.rate);null!=a.volume&&(F.value=a.volume);a.mode&&(w=a.mode,G.value=a.mode);a.top&&(C.style.top=a.top);a.left&&(C.style.left=a.left)}catch{}}function V(a={}){try{const b=C.getBoundingClientRect();localStorage.setItem("praSettingsV2",JSON.stringify(Object.assign({themeIndex:S,compact:T,rate:E.value,volume:F.value,mode:G.value,top:C.style.top||b.top+"px",left:C.style.left||""},a)))}catch{}}function W(){C.style.background=R[S%R.length]}function X(){C.style.width=T?"220px":"360px";C.style.fontSize=T?"12px":""}U();W();X();N.onclick=()=>{S=(S+1)%R.length;W();V()};O.onclick=()=>{T=!T;X();V()};function Y(){t&&(t.parentNode&&t.parentNode.replaceChild(document.createTextNode(t.textContent),t),t=null)}function Z(a){return a.split(/(?<=[.!?])\s+/).filter(Boolean)}function $(){u=[...document.querySelectorAll("p")].filter(a=>a.innerText.trim());v=0}function _(a,b){q.cancel();Y();if(!a||!a.trim())return;s=new SpeechSynthesisUtterance(a);s.voice=r.find(c=>c.name===D.value)||r[0];s.rate=parseFloat(E.value)||1;s.volume=parseFloat(F.value)||1;const c=a.split(/(\s+)/);let d=0;s.onboundary=e=>{if("word"!==e.name)return;Y();if(!b)return;try{const f=document.createRange(),g=document.createTreeWalker(b,NodeFilter.SHOW_TEXT);let h,i=0;for(;h=g.nextNode();){const j=h.textContent.length;if(i+j>=e.charIndex){const k=e.charIndex-i,l=c[d]||"";f.setStart(h,k);f.setEnd(h,Math.min(k+l.length,h.textContent.length));break}i+=j}if(!f.collapsed){const j=document.createElement("span");j.className="a1";try{f.surroundContents(j);t=j;j.scrollIntoView({behavior:"smooth",block:"center"})}catch{}}}catch{}d++};s.onend=()=>{Y();x=!1};q.speak(s);x=!0}function a0(){if(!u.length)return;const a=u[v],b=a.innerText;if("sentence"===w){const c=Z(b);let d=0;!function e(){if(d>=c.length){x=!1;return}_(c[d++],a);s.onend=()=>{Y();e()}}()}else _(b,a)}function a1(){v<u.length-1&&(v++,a0())}function a2(){v>0&&(v--,a0())}H.onclick=()=>{const a=getSelection();a&&a.toString().trim()?_(a.toString(),a.anchorNode&&a.anchorNode.parentElement):(!u.length&&$(),a0());V()};I.onclick=()=>{q.paused?q.resume():q.pause()};J.onclick=()=>{q.cancel();Y();x=!1};L.onclick=()=>{q.cancel();Y();a1()};K.onclick=()=>{q.cancel();Y();a2()};M.onclick=()=>{$();a0()};G.onchange=()=>{w=G.value;V()};E.oninput=()=>V();F.oninput=()=>V();Q.onclick=()=>{q.cancel();Y();_("This is "+A()+" "+B()+". Ready when you are.",null);V()};P.onclick=()=>{q.cancel();Y();C.remove();z.remove();window.__PRA2_V2=0};let a3=!1,a4=0,a5=0;C.addEventListener("mousedown",a=>{if(["BUTTON","SELECT","INPUT"].includes(a.target.tagName))return;a3=!0;a4=a.offsetX;a5=a.offsetY});document.addEventListener("mouseup",()=>{a3&&(a3=!1,V())});document.addEventListener("mousemove",a=>{if(!a3)return;const b=Math.max(0,Math.min(innerWidth-C.offsetWidth,a.clientX-a4)),c=Math.max(0,Math.min(innerHeight-C.offsetHeight,a.clientY-a5));C.style.left=b+"px";C.style.top=c+"px";C.style.right="auto"});y(()=>{D.innerHTML="";r.forEach(a=>{const b=document.createElement("option");b.textContent=a.name;b.value=a.name;D.appendChild(b)});try{const a=JSON.parse(localStorage.getItem("praSettingsV2")||"{}");a.voiceName&&r.some(b=>b.name===a.voiceName)&&(D.value=a.voiceName)}catch{}D.onchange=()=>V({voiceName:D.value})});console.log("Loaded "+A()+" "+B())}catch(a){console.error("Error:",a)}})();
